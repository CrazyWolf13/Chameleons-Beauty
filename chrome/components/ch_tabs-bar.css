/* Source file made available under Mozilla Public License v. 2.0 See the main repository for updates as well as full license text. 
   https://github.com/Godiesc/Chameleons-Beauty */

#navigator-toolbox {
    /* Remove navigator-toolbox image */
    background-image: none !important;
    background-color: transparent !important;
    /* Fix dark effect when urlbar is 'open' */
    z-index: unset !important;
}

/* Set the image to all body */

#main-window {
    --my-background-image: var(--lwt-additional-images), var(--lwt-header-image, none),
        linear-gradient(var(--lwt-accent-color, Field), var(--lwt-accent-color, Field)) !important;
    --my-background-position-y: top;
    background-image: var(--my-background-image);
    background-repeat: var(--lwt-background-tiling);
    background-position: var(--lwt-background-alignment);
    background-position-y: var(--my-background-position-y) !important;
    background-color: var(--toolbar-bgcolor) !important;
    background-size:var(--my-background-size, auto) !important;
    
    /* Allow blur effect in Firefox UI elements - round 1px is necessary */
    clip-path: xywh(0 0 100% 100% round 1px) !important;
}

/* Gradient effect to the bottom */

#main-window>body::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to top, color-mix(in srgb, var(--contrast-color), var(--lwt-accent-color)) 50%, var(--toolbar-bgcolor) calc(100% - var(--tab-height-personal) - var(--toolbar-height-personal)));
    z-index: -1 !important;
}

#main-window:is([lwtheme-image],[style*="--lwt-additional-images"]) >body::after {
    background: linear-gradient(to top, color-mix(in srgb, var(--contrast-color) 80%, var(--lwt-accent-color)) calc(100% - 190px), var(--toolbar-bgcolor) calc(100% - 100px));
}

/* Remove unnecessary background to show the theme image
   Transparent background to toolbars, sidebar, browser content and web content */

toolbar,
#sidebar,
#browser,
#tabbrowser-tabpanels {
    background-color: transparent !important;
}

/* Remove unwanted background to all browser background */

#browser:not(.browser-toolbox-background):not(#tabbrowser-tabpanels) {
    :root[lwtheme] & {
        background-image: none !important;
    }
}

/* ___________________________________________________________ Selected tab ___________________________________________________________
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */
/* Necessary so that the first 'selected' tab does not remain under 'left-sidebar' */

.tabbrowser-tab {
    --tab-min-width-pref: var(--tab-min-width-personal) !important;                             /* New tab min width */
    --tab-selected-outline-color: var(--identity-tab-color, transparent) !important;            /* Selected tab border color - here to improve the tab corners */
}

/* Gradient border in selected tab */

.tabbrowser-tab[visuallyselected] .tab-background {
    &::before,
    &::after {
        content: "";
        position: absolute;
        inset: 0px;
        padding: 1px;
        margin-block: var(--tab-block-margin) !important;
        border-radius: var(--tab-border-radius);
        background: repeat var(--identity-icon-color, var(--gradient)) !important;
        background-repeat: no-repeat !important;
        mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
        mask-composite: exclude;
        pointer-events: none !important;
        
        /* For 'Vertical tabs' */
        @media -moz-pref("sidebar.verticalTabs") {
            margin-inline: var(--my-margin-inline-inner-tab) !important;
        }
    }
}

/* ____________________________________________________ Style for horizontal tabs _____________________________________________________
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

@media not -moz-pref("sidebar.verticalTabs") {
    
    /* Space before first tab */
    #tabbrowser-tabs :not(tab-group)>.tabbrowser-tab:first-of-type {
        padding-inline-start: 3px !important;
    }

    #tabbrowser-arrowscrollbox,
    #pinned-tabs-container {
        &[orient="horizontal"] {

            #tabs-newtab-button {
                padding-inline-start: 1px !important;
            }

            /* Align 'tab-content' */

            .tab-content {
                margin-block-end: calc(1px - var(--my-tab-margin-top)) !important;
            }
        }
    }
}

/* ______________________________________________________ Stye for vertical tabs ______________________________________________________
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

@media -moz-pref("sidebar.verticalTabs") {

    :root {
        --my-margin-inline-inner-tab: 4px;                                                    /* Used to center tabs */
        --tab-block-margin: 0px !important;                                                   /* Tab margins  */
        --tab-overflow-clip-margin: 0px !important;                                           /* Remove unwanted margin - hide unwanted scroll
                                                                                                 tested in pinned tabs 'sidebar collapsed' */

        --my-separator-border-style1:linear-gradient(to right,                                /* Separator style */
            transparent 6px, var(--my-content-border-color) 6px,
            var(--my-content-border-color) calc(100% - 6px), transparent calc(100% - 6px)) 1;
    }

    /* Remove unwanted space between tabs tabs */

    #tabbrowser-tabs[orient="vertical"] {
        --tab-height-with-margin-padding: var(--tab-min-height) !important;                   /* Remove unwanted tab extra height for pinned tabs */
        & #pinned-tabs-container .tabbrowser-tab {                                            /* Remove unwanted padding in Pinned tabs */
            padding-block: 0px !important;
        }

        & .tabbrowser-tab {                                                                   /* Remove unwanted padding in Normal tabs */
            padding-block: 1px !important;
        }
    }

    /* Remove unwanted background-color of pinned tabs */

    #pinned-tabs-container {
        & .tab-background {
            .tabbrowser-tab:not(:hover) > .tab-stack > &:not([selected], [multiselected]) {
                background-color: transparent !important;
            }
        }
    }
    
    /* Keep the same pinned tab width when sidebar is expanded */

    @media not -moz-pref("sidebar.visibility", "expand-on-hover") { 
        #tabbrowser-tabs[orient="vertical"][expanded] {
            & .tabbrowser-tab[pinned] {
                width: var(--my-vertical-elements-width) !important;
            }
        }
    }
    
    slot[part="items-wrapper"] {
        padding-inline: 0px !important;
        grid-template-columns: repeat( auto-fit, minmax(var(--my-vertical-elements-width), auto)) !important;
    }

    /* Tabs big container */

    #tabbrowser-tabs[orient="vertical"] {
        /* Used for pinned tabs */
        --tab-collapsed-width: var(--my-vertical-elements-width) !important;
        /* used for normal tabs */
        width: var(--my-vertical-elements-width) !important;
    }

    /* Width of tabs */

    #tabbrowser-tabs[orient="vertical"] {
        /*--tab-collapsed-background-width: calc(var(--my-vertical-elements-width) - var(--my-margin-inline-inner-tab)*2) !important;/**/
        .tab-background {            
            margin-inline: var(--my-margin-inline-inner-tab) !important;
            /*min-width: calc(var(--my-vertical-elements-width) - var(--my-margin-inline-inner-tab)*2) !important;/**/
            border-radius: var(--tab-border-radius) !important;
        }
    }
    
    /* _____ Various separators _____
       ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */
    
    /* Margin top of the block of tabs */    
    #vertical-tabs {
        padding-block-start: 7px !important;
    }
    
      /* Separator bottom when tabs scroll appears */
    #tabbrowser-tabs[orient="vertical"] {
        &[overflow]::after {
            content: "";
            border-bottom: var(--tabstrip-inner-border);
            margin-inline: 0px !important;
            border-image: var(--my-separator-border-style1) 1 !important;
        }
    }
    
    /* Tabs top separador 
    :root:not([sizemode="fullscreen"]) {
        & #sidebar-main::before {
            position: fixed; content: '';
            width: 100%;
            border-block-start: 1px solid var(--my-content-border-color);
            border-image: var(--my-separator-border-style1) 1 ;
        }
    }*/
    
    /* Pinned bottom separator */
    #vertical-pinned-tabs-splitter {
        #tabbrowser-tabs #pinned-tabs-container:not(:empty) > &, 
        #pinned-tabs-container:not(:empty) + & {
            margin-inline: 0px !important;
            display: flex !important;
            border-image: var(--my-separator-border-style1) 1 !important;
        }
    }
    
    /* Separator top of tools */    
    #sidebar-tools-and-extensions-splitter {
        border-block-width: 0px !important;
        background-color: transparent !important;
        pointer-events: none !important;
    }
    
    /* _______________________ New Tab button _______________________
    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */
    #tabbrowser-tabs :is(#tabs-newtab-button, #vertical-tabs-newtab-button),
    #new-tab-button {
        border-radius: 0px !important;

        &::before {
            content: ''; position: absolute; 
            min-height: calc(var(--tab-height-personal) - 8px);
            width: calc(var(--tab-height-personal) - 8px);
            border-radius: var(--tab-border-radius);
        }

        &:hover::before {
            background: var(--button-background-color-ghost-hover) !important;
        }
    }

    /* Width when sidebar isn't expanded */    
    #tabbrowser-tabs[orient="vertical"]:not([expanded]) {
        & #tabs-newtab-button,
        & #vertical-tabs-newtab-button{
            &:not([expanded]) {
                width: var(--my-vertical-elements-width) !important;
            }
        }
    }

    #tabbrowser-tabs[orient="vertical"] {
        #tabs-newtab-button,
        #vertical-tabs-newtab-button {
            --tab-hover-background-color: transparent !important;
            margin-inline: 0px !important;

            &::before {
                min-height: calc(var(--tab-collapsed-background-width) - 8px);
                width: calc(var(--tab-collapsed-background-width) - 8px);
            }
        }
    }

    /* When Sidebar is expanded */
    sidebar-main:is([expanded]) {
        #tabbrowser-tabs[orient="vertical"] {
            & #tabs-newtab-button,
            & #vertical-tabs-newtab-button {
                --tab-icon-end-margin: 5.5px !important;
                padding-inline-start: calc(var(--my-vertical-elements-width)/2 - 8px) !important;
                border-radius: 0px !important;

                &::before {
                    inset-inline-start: 8px !important;
                    width: calc(100% - 16px) !important;
                }

                & .toolbarbutton-text {
                    mask: linear-gradient(to right, #e66465 calc(100% -  26px), #00000000 calc(100% - var(--my-vertical-elements-width)/2 + 8px)) !important;
                }
            }
        }
    }

    /* ______________________________ fix glich when using default 'expand-on-hover' ______________________________
    ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

    :root[sidebar-expand-on-hover] {
        & #sidebar-main {
            background: transparent !important;
            
            &[sidebar-launcher-expanded], &[sidebar-ongoing-animations]:not([sidebar-launcher-expanded]) {
                border-color: var(--my-content-border-color) !important;
                
                &::before{
                    content: ''; display: block; width: 100%; height: 100%;
                    position: absolute;
                    background-image: linear-gradient(var(--toolbar-bgcolor), var(--toolbar-bgcolor)),
                        var(--lwt-header-image, none), var(--lwt-additional-images,none),
                        linear-gradient(var(--lwt-accent-color,Field), var(--lwt-accent-color,Field)) !important;
                    background-position: left top !important;
                    background-position-y: top !important;
                    background-size: auto 100% !important;
                    opacity: 0.98;
                }
            }
        }
    }
}

/* ___________________________________________________________ Various Styles ___________________________________________________________
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

/* Tab width reach a smaller size
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

#tabbrowser-tabs[orient="horizontal"] .tabbrowser-tab:not([pinned])[fadein] {
    container-name: smaller-tab;  /* used too in ogx_sound.css */
    container-type: inline-size;
}

@container smaller-tab (width < 48px) {
    #tabbrowser-tabs[orient="horizontal"] .tabbrowser-tab:not([pinned])[fadein] {

        /* Remove unwanted elements */
        .tab-close-button,
        .tab-label-container {
            display: none !important;
        }

        /* Remove unwanted margins */
        .tab-content {
            --tab-inline-padding: 0px !important;
            --tab-icon-end-margin: 0px !important;
        }

        /* Centered favicon */
        .tab-icon-stack {
            margin-inline: auto !important;
        }
    }
}

/* Aligned tabs-bar buttons */

#TabsToolbar .toolbarbutton-1 {
    padding-block: var(--tab-block-margin) !important;
}

/* Scroll de pestañas */

#tabbrowser-arrowscrollbox {
    --scrollbuttons-margin-block-end: 0px;
    --scrollbuttons-border-radius: 7px;
}

#scrollbutton-up, #scrollbutton-down {
    margin-block-end: var(--scrollbuttons-margin-block-end, 0px) !important;

    &:not([disabled]) {
        background-color: color-mix(in srgb, var(--tab-selected-textcolor) 10%, transparent) !important;
        border-radius: var(--scrollbuttons-border-radius, 0px) !important;
        transition-duration: 0.2s !important;

        &:hover {
            background-color: color-mix(in srgb, var(--tab-selected-textcolor) 30%, transparent) !important;
        }
    }
}

/* Show generic favicon when sithe don't give any */

.tab-icon-image {
  #tabbrowser-tabs[orient="horizontal"] &:not([src], [pinned], [crashed], [sharing], [pictureinpicture], [busy]) {
      display: flex !important;
    }
}

/* Remove "Private navigation" label */

.private-browsing-indicator-label {
    display: none !important;
}

/* Color y posición "dot" de pestaña que necesita atención */

.tabbrowser-tab > .tab-stack > .tab-content[pinned][titlechanged]:not([selected]) {
  background-image: radial-gradient(circle, var(--button-active-bgcolor1), var(--button-active-bgcolor1) 2px, transparent 2px) !important;
  background-position: center top calc(4px + var(--tabs-navbar-shadow-size)) !important;
}

/* Code to tabs-bar reach lower height that 30px */

.titlebar-buttonbox-container, .tab-close-button, .tab-label-container{
  max-height: calc(var(--tab-height-personal) + var(--my-tab-margin-top) + var(--my-tab-margin-bottom)) !important;
    
    /* Align for 'Vertical tabs' or 'tree-tabs' */
    @media (-moz-pref("firefoxgx.tree-tabs") or -moz-pref("sidebar.verticalTabs")) {
        --tab-height-personal: var(--toolbar-height-personal) !important;
    }
}

/* ________________________ Firefox-view ________________________
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

#firefox-view-button{ list-style-image: url("../icons/firefoxview-close.svg") !important; }
#firefox-view-button[aria-pressed="true"] { list-style-image: url("../icons/firefoxview-open.svg") !important; }

toolbar:is(#TabsToolbar) #firefox-view-button{ padding-left: 8px !important; }

:root:not([privatebrowsingmode="temporary"]) :is(toolbarbutton, toolbarpaletteitem) + #tabbrowser-tabs, :root[privatebrowsingmode="temporary"] :is(toolbarbutton:not(#firefox-view-button), toolbarpaletteitem:not(#wrapper-firefox-view-button)) + #tabbrowser-tabs {
  border-inline-start: 0px solid transparent !important;
}

toolbar:is(#TabsToolbar) #firefox-view-button .toolbarbutton-icon{
    border-radius: 4px !important;
    margin: -2px !important;
    height: calc(var(--tab-height-personal) - 6px) !important;
    width: calc(var(--tab-height-personal) - 6px) !important;
    padding: 4px !important;
}

toolbar:is(#TabsToolbar, #PersonalToolbar) #firefox-view-button[aria-pressed="true"] .toolbarbutton-icon{
    outline: none !important;
    border-radius: 4px !important;
    background: var(--button-hover-bgcolor) !important;
    fill: var(--arrowpanel-color, var(--tab-selected-textcolor)) !important;
}

 toolbar #firefox-view-button[aria-pressed="true"] .toolbarbutton-icon{
    background: var(--button-hover-bgcolor) !important;
    fill: var(--arrowpanel-color, var(--tab-selected-textcolor)) !important;
}

/* ________________________ Tab Preview _________________________
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

.tab-preview-thumbnail-container {    
    border-top-color: var(--my-content-border-color) !important;
}

#tab-preview-panel {
    margin-block-start: 2px !important;
    border-radius: var(--arrowpanel-border-radius) !important;
    box-shadow: inset 0 0 0 1px var(--my-content-border-color) !important;
}

@media -moz-pref("sidebar.verticalTabs") {
    #tab-preview-panel {
        margin-block-start: -3px !important;
        margin-inline: 1px !important;
    }
}

/* _____________________________________________________________ Menu-bar _____________________________________________________________
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ */

/* Set height of all toolbar */
#toolbar-menubar {
    height: var(--menubar-height-personal) !important;
}

/* Alignt menu items - tested when menu is always active */
menubar > menu {
    @media (-moz-platform: windows) {
        padding: 1px 6px 3px !important;
    }
}

/* __ Menubar Flotante __ */

#toolbar-menubar[autohide]{
    position: fixed;
    display: flex;
    top: 0px !important;
    width: 100vw;
    height: initial !important;
    z-index: 10;
}

#toolbar-menubar:not([autohide]) #main-menubar {
    background-color: transparent !important;
    box-shadow: none !important;

    &>menu[_moz-menuactive] {
        background-color: var(--button-bgcolor) !important;
        border-radius: 0 0 4px 4px !important;
    }
}

#toolbar-menubar[autohide] #main-menubar {
    height: var(--menubar-height-personal) !important;
    background: linear-gradient(var(--my-toolbar-bgcolor, var(--toolbar-bgcolor)), var(--my-toolbar-bgcolor, var(--toolbar-bgcolor))),
                      var(--lwt-header-image, none), var(--lwt-additional-images,none),
                      linear-gradient(var(--lwt-accent-color,Field), var(--lwt-accent-color,Field)) !important;
    background-position: 0 0, right top , var(--lwt-background-alignment) !important;
    background-position-y: top !important;
    background-repeat: repeat-x, no-repeat, var(--lwt-background-tiling) !important;
    background-size: var(--my-background-size, auto 100%, var(--lwt-background-size)) !important;
    background-attachment: fixed, fixed, fixed !important;
    outline: 1px solid var(--my-content-border-color) !important;
    outline-offset: -1px !important;
    border-radius: 8px !important;
    margin-block: 4px !important;
    margin-inline-start: 4px !important;    
    padding-inline: 4px !important;
    box-shadow: 5px 0 5px 1px var(--contrast-color) !important;
}

#toolbar-menubar[autohide]:not([inactive]) #main-menubar>menu {
    margin-block: 4px !important;
    border-radius: 4px !important;
    
    &[_moz-menuactive] {
        background-color: var(--button-active-bgcolor) !important;
    }
    
    &::before {
        top: 0;
        content: "";
        position: fixed;
        height: 8px;
        width: 76px;
    }
}

#toolbar-menubar[autohide][inactive]{ height: 0px !important; }

#toolbar-menubar > spacer{ flex-grow: 1 }
#toolbar-menubar[inactive] > .titlebar-buttonbox-container{ display: none }

@media (-moz-gtk-csd-reversed-placement){
    #toolbar-menubar[autohide]:not([inactive]) > .titlebar-buttonbox-container{ display: none }  
}

/* _______________________ Configuration for Linux _______________________ */

@media (-moz-platform: linux) {
    
    /* Elimina padding indeseado de la barra de menú */
    toolbar { &[type="menubar"] { padding: 0px !important; }}
}