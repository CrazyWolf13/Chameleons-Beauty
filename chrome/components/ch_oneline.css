/* Source file made available under Mozilla Public License v. 2.0 See the main repository for updates as well as full license text. 
   https://github.com/Godiesc/Chameleons-Beauty/ */

@media -moz-pref("firefoxchameleon.oneline") and (not -moz-pref("sidebar.verticalTabs")) and (not -moz-pref("firefoxchameleon.tree-tabs")) {

  /* ¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡ IMPORTANT: To only apply one-line config to screen bigger than some px !!!!!!!!!!!!!!!!!!!!!!!!!! */

  @media screen and (min-width: 1000px) {

    /* ####################################### Window controls from MrOtherGuy ############################################ */

    /* Source file https://github.com/MrOtherGuy/firefox-csshacks/tree/master/chrome/window_control_placeholder_support.css */

    /* overwriting: Modify these values to match your preferences */

    @media (-moz-platform: windows) {
      :root:is([customtitlebar], [sizemode="fullscreen"]) {
        --uc-window-control-width: 162px;                   /* Space reserved for window controls (Win10) */      
      }
    }

    @media (-moz-platform: macos){
      :root:is([customtitlebar],[sizemode="fullscreen"]) {
        --uc-window-control-width: 72px;
      }
    }

    /* On linux set width based on number of caption buttons.
    One button
    Two buttons 
    Three buttons 
    -> Code added in 'ogx_windows_controls.css' */

    /* #################################################### One-Line from MrOtherGuy ############################################## */

    /* Source file https://github.com/MrOtherGuy/firefox-csshacks/tree/master/chrome/navbar_tabs_oneliner_menu_buttons_on_right.css */

    /* overwriting: reserved space for overflow + menu buttons */

    #navigator-toolbox {
      --uc-buttons-width: calc(var(--uc-window-control-width, 20px) - 45px) !important;
    }

    /* Less space when overflow is empty */

    #navigator-toolbox:has(#nav-bar:not([nonemptyoverflow])) {
      --uc-buttons-width: calc(var(--uc-window-control-width, 0px) - 10px) !important;
      --uc-space-to-reduce: 26px;
    }

    /* '--uc-buttons-width' inprivate window */

    :root:is([privatebrowsingmode="temporary"])  #navigator-toolbox{
      --uc-buttons-width: calc(var(--uc-window-control-width, 22px) - 15px) !important;
    }

    /* Margins inline of tabsbar toolbar - makes space for unmovable items */

    .toolbar-items{
      margin-inline-start: calc(var(--navbarWidth));
      margin-inline-end: calc(var(--uc-window-control-width, 22px) - var(--uc-buttons-width) + 44px) !important;
    }

    /* Makes tabsbar items clicleable */
    
    #TabsToolbar { 
      will-change: unset !important; 

      & > .toolbar-items {  
        z-index: 3 !important;
      }
    }

    /* _____________________________________________________________________ MY CODE _______________________________________________________________________
    ################################################### Además de sobre-escribir el código de arriba ####################################################  */

    /* Nuevas variables generales */

    :root:not([chromehidden*="menubar"]) {
      --tab-block-margin: 4px 3px !important;                                                             /* Nuevo margen de pestaña */
      --my-tab-margin-top: 4px !important;
      --my-tab-margin-bottom: 3px !important;                                                             /* necessary for calc */
      --toolbar-height-personal: calc(var(--tab-height-personal) +                                        /* Toolbar height */
        var(--my-tab-margin-top) + var(--my-tab-margin-bottom)) !important;
      --navbarWidth:31vw;                                                                                 /* Set width of navbar */
      --min-width-url: 22.5vw !important;                                                                 /* Tamaño url */

      @media -moz-pref("sidebar.revamp") {
        --min-width-url: 20.1vw !important;                                                             /* Set width of navbar when using 'revamp' */
      }
    }

    /* Align the navbar gradient line with selected tab, and trick to vertically center all elements */ 

    :root:not([chromehidden*="menubar"]) {
      #nav-bar {
        --toolbar-bgcolor: transparent !important;
        margin-inline-start: var(--padding-left-tab, 0px) !important;
        padding-inline-end: calc(var(--uc-window-control-width, 28px)) !important; /* 20px when 'without control buttons' */
        margin-block-start: calc(-1* var(--toolbar-height-personal)) !important;
      }

      /* Remove right padding of hamburger menu button */

      #PanelUI-menu-button {
        padding-inline-end: 0px !important;
      }

      /* Unified extension button on right - Immovable */

      #unified-extensions-button{
        position: absolute;
        display: flex;
        top: 0 !important;
        padding-block: 7px !important;
        inset-inline-end: calc(var(--uc-window-control-width, 28px) + 61px - var(--uc-space-to-reduce, 0px)) !important;
      }

      /* Position 'Unified extension button' when aren't items in overflow button */
      :root:has(#nav-bar:not([nonemptyoverflow])) #unified-extensions-button {
        right: calc(var(--uc-window-control-width) + 37px) !important;
      }
    }

    /* Ocultar el botón de extensiones cuando no hay items in overflow button - customization mode */

    :root:is([customizing]) #nav-bar:not([nonemptyoverflow]) #unified-extensions-button{
      opacity: 0 !important;
    }

    /* Ocultar botón "unified extension" en modo "pantalla completa" */

    :root:is([chromehidden~="toolbar"], [sizemode="fullscreen"])>body>#browser, :root:is([chromehidden~="toolbar"], [sizemode="fullscreen"])>body>#browser-bottombox,
    :root:is([chromehidden~="toolbar"], [sizemode="fullscreen"])>body>#customization-container {
      z-index: 3 !important;
    }

    /* _______ trick to be able to click on extensions from the top edge of the nav-bar */

    #TabsToolbar toolbaritem .toolbarbutton-1 {
      margin-block-end: -1px !important;
      padding-block: 6px !important;
    }

    /* _____________________________________________________________ Url-bar _____________________________________________________________ */

    /* Smaller urlbar */

    #urlbar, #searchbar {
      --urlbar-height: calc(var(--toolbar-height-personal) - 8px) !important;
      --urlbar-min-height: calc(var(--toolbar-height-personal) - 8px) !important;
    }

    /* Url icons  */

    .urlbar-page-action, .urlbar-revert-button, .urlbar-go-button, .search-go-button,                 /* Page action buttons */
    .identity-box-button,                                                                             /* Lock */
    #notification-popup-box,                                                                          /* Password... */
    #tracking-protection-icon-container {                                                             /* Shield */
      height: calc(var(--urlbar-min-height) - 2px - 2 * var(--urlbar-container-padding)) !important;
    }

    .urlbar-page-action, .urlbar-revert-button, .urlbar-go-button, .search-go-button {
      width: unset !important;
    }

    /* Blur at the end of "Search with..." */

    #urlbar[pageproxystate="invalid"]:not([usertyping],[searchmode],[open]) #urlbar-input{
      mask-image: linear-gradient(to right, black calc(var(--min-width-url) - 60px), transparent calc(var(--min-width-url) - 36px)) !important;
    }

    #urlbar:not([open],:hover, [focused]) #urlbar-input {
      mask-image: linear-gradient(to right,  transparent 0%, #fff 10% 80%, transparent 90%) !important;
    }

    /* urlbar when 'focus' and 'open' */

    #urlbar-container, #urlbar-container:not([open],:focus, :focus-within ){
      max-width: var(--min-width-url) !important; 
    }

    #urlbar:focus-within, 
    #urlbar[focused],
    #urlbar[open] { 
      min-width: calc(var(--min-width-url) + 340px) !important;
      clip-path: polygon(0px 0%, var(--min-width-url) 0%, 0% 999999vw, 0% 0px) !important;

      &:dir(rtl) {
        clip-path: polygon(calc(100% - var(--min-width-url)) 0, 100% 0%, 100% 100%, calc(100% - var(--min-width-url)) 100%) !important;
      }
    }

    #urlbar[open]{
      clip-path: none !important;

      &:dir(rtl) {
        clip-path: none !important;
      }
    }

    /* Allows you to make space to move icons in 'customization mode' */

    :root:is([customizing]) {
      #urlbar {
        max-width: calc(3.5vw) !important; 
      }

      #wrapper-urlbar-container {
        max-width: calc(var(--min-width-url) - 6vw) !important; 
      }
    }

    /* Urlbar text centered */

    #urlbar:not([focused]) .urlbar-input{ text-align: center !important; }

    /* Modified "show more bookmarks" icon */

    #PlacesChevron>image {
      transform: rotate(90deg);
    }
  
    /* Urlbar icons - show on 'hover' */

    #identity-box>box:not([open])>:is(image, box), 
    #urlbar-searchmode-switcher:not([open]), 
    #urlbar-zoom-button, .urlbar-page-action:not([open])>image {
      opacity: 0 !important;
      transition: opacity 250ms ease-in-out !important;
    }

    #urlbar:is([open],:hover,[focused]) :is(#identity-box>box>:is(image, box),
    #urlbar-searchmode-switcher,
    #urlbar-zoom-button, .urlbar-page-action>image) {
      opacity: 1 !important;
      transition: opacity 250ms ease-in-out !important;
    }
  
     /* Removed urlbar icons */

    #tracking-protection-icon-container,  /* Shield icon */
    #userContext-icons {                  /* Container icon */
      display: none !important 
    }

    /* Smaller tabs-bar buttons - fix tabs-bar height */

    .toolbarbutton-1:not([disabled="true"], #tabs-newtab-button, #new-tab-button){
      --toolbarbutton-inner-padding: 5px !important;
    }

    /* _______ trick to be able to click on extensions from the top edge of the nav-bar */

    #TabsToolbar toolbaritem .toolbarbutton-1 {
      margin-block-end: -1px !important;
      padding-block: 7px !important;
    }

    /* _________________________________________ Compatibilidad con <window controls> on left en linux _________________________________________ */

    @media (-moz-gtk-csd-reversed-placement){

      :root{
        --navbarWidth:36.3vw;                                                                                     /* Set width of navbar */
      }

      /* Sobreescribir el margen a la derecha */

      #nav-bar{
        margin-inline-start: calc(var(--uc-window-control-width) - 20px)  !important;
        padding-inline-end: 20px !important;
      }

      #navigator-toolbox{
        --uc-buttons-width: 97px
      }

      /* Unified extension button on right - Immovable */

      #unified-extensions-button{
        position: fixed;
        display: flex;
        right: calc(var(--uc-window-control-width) - 39px) !important;
        top: 0px !important;
        padding-block: 6px !important;
        z-index: 3 !important;
      }

      /* Quitar separador de  <window controls> de la derecha*/

      #PanelUI-menu-button::after {
        display: none !important;
        margin-right: 6px !important;
      }

      /* Espacio derecha para arratrar ventana */

      #PanelUI-button {
        margin-right: 6px !important;
      }

      /* Poner Separador <window controls on left> y demás botones */

      :root:not([chromehidden~="toolbar"]) #nav-bar-customization-target > :is(toolbarbutton, toolbaritem):first-child::before {
        background: url("../icons/urlbar-separator.svg") no-repeat !important; 
        content: ""; display: block !important;
        background-size: 6px 16px !important;
        width: 6px !important;
        height: 16px;
        fill: var(--button-active-bgcolor) !important;
        -moz-context-properties: fill !important;
        margin-left: -10px !important;
        margin-right: 4px !important;
        opacity: 0.8;
      }  

      /* Nueva posición <window controls> al borde izquierdo */

      .titlebar-buttonbox {
        appearance: none !important;
        position: fixed !important;
        display: flex !important;
        height: calc(var(--tab-height-personal) + var(--margin-top) * 2) !important;
        top: var(--windowed-top-padding, 0px) !important;
        left: var(--uc-vertical-toolbar-width,0) !important;
        background: transparent !important;
        padding-left: 2px !important;
        z-index: 2 !important;

      }
    }
  }
}